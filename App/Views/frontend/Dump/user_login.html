{% extends "frontend/partitions/layout.html" %}
{% block body %}
<style>
    .submitbtn {
        pointer-events: none;
        opacity: 0.4;
    }
</style>

<div class="main-content main-content-login">

    <div class="success_alert">{% include "frontend/partitions/notification.html" %}</div>

    <div class="container">
        <div class="row">
            <div class="col-lg-12">
                <div class="breadcrumb-trail breadcrumbs">
                    <ul class="trail-items breadcrumb">
                        <li class="trail-item trail-begin">
                            <a href="/">Home</a>
                        </li>
                        <li class="trail-item trail-end active">
                            Authentication
                        </li>
                    </ul>
                </div>
            </div>
        </div>
        <div class="row">
            <div class="content-area col-lg-12 col-md-12 col-sm-12 col-xs-12">
                <div class="site-main">
                    <h3 class="custom_blog_title">
                        Authentication
                    </h3>


                    <div class="customer_login">
                        <div class="row">
                            <div class="col-lg-6 col-md-6 col-sm-12">
                                <!-- <div class="d-flex email_phoneLogin">
                                    <div id="login_Email" class="col-lg-6 col-md-6 col-sm-12 text-center emaila_login">
                                        Login with
                                        email</div>
                                    <div id="login_Phone" class="col-lg-6 col-md-6 col-sm-12 text-center emaila_login">
                                        Login with
                                        mobile</div>
                                </div> -->
                                <div class="login-item">
                                    <!-- <h5 class="title-login">Login your Account</h5> -->
                                    <div class="d-flex email_phoneLogin">
                                        <div id="login_Email"
                                            class="col-lg-6 col-md-6 col-sm-12 text-center emaila_login">Login with
                                            email</div>
                                        <div id="login_Phone"
                                            class="col-lg-6 col-md-6 col-sm-12 text-center emaila_login">Login with
                                            mobile</div>
                                        <br />
                                    </div>
                                    <input type="hidden" id="ismobile" value="{{ismobile}}" />

                                    <form id="loginSubmit_email" class="login" action="/login_User" method="post">
                                        <p>
                                            <span id="mobile-valid" class="hidden mob">

                                            </span>
                                            <span id="folio" class="hidden ">

                                            </span>
                                        </p>
                                        <p class="form-row form-row-wide">
                                            <label class="text">Email</label>
                                            <input title="username" name="email" type="email" class="input-text"
                                                required>
                                        </p>
                                        <p class="form-row form-row-wide">
                                            <label class="text">Password</label>
                                            <input title="password" name="user_password" id="password" minlength="6"
                                                maxlength="6"
                                                placeholder="Use 6 characters with a mix of letters, numbers & symbols"
                                                type="password" class="input-text" required>
                                        </p>
                                        <p class="lost_password">
                                            <span class="inline">
                                                <input type="checkbox" name="rememberMe" id="cb1">
                                                <label for="cb1" class="label-text">Remember me</label>
                                            </span>
                                            <a href="/forgot_password" class="forgot-pw">Forgot password?</a>
                                        </p>
                                        <p class="form-row">
                                            <input type="submit" class="button-submit" value="login">
                                        </p>
                                    </form>

                                    <!-- <a class="btn btn-lg btn-success" href="/google"
                                    >Continue With Google</a> -->

                                    <form id="loginSubmit_mobile" class="login" action="/login_User_otp" method="post">
                                        <p>
                                            <span id="mobile-valid" class="hidden mob">

                                            </span>
                                            <span id="folio-invalid" class="hidden  mob-helpers">
                                                Please enter valid mobile No
                                            </span>
                                        </p>
                                        <p class="form-row form-row-wide">
                                            <label class="text">Mobile </label>
                                            <input title="Mobile" name="phone" id="mobile-num1" type="text"
                                                class="input-text" maxlength="10" required>
                                        </p>
                                        <p class="form-row">
                                            <input type="submit" class="button-submit" value="Send OTP">
                                        </p>
                                        <!-- <div id="otp_Send" class="otpBtn">Send OTP -->
                                        <!-- </div> -->
                                        <!-- <p class="form-row">
                                            <input id="otp_Send" class="button-submit" value="Send OTP">
                                        </p> -->
                                        <!-- <div class="moblie_otpLogin">

                                            <p class="form-row form-row-wide">
                                                <label class="text">Confirm OTP</label>
                                                <input title="password" name="password" minlength="6" maxlength="6"
                                                    type="password" class="input-text" value="" required>
                                            </p>
                                            <p class="lost_password">
                                                <span class="inline">
                                                    <input type="checkbox" name="rememberMe" id="cb1">
                                                    <label for="cb1" class="label-text">Remember me</label>
                                                </span>
                                                <a href="#" class="forgot-pw">Forgot password?</a>
                                            </p>
                                            <p class="form-row">
                                                <input type="submit" class="button-submit" value=" Login">
                                            </p>

                                        </div> -->
                                    </form>
                                </div>
                            </div>
                            <div class="col-lg-6 col-md-6 col-sm-12">
                                <div class="login-item">
                                    <h5 class="title-login">Register now</h5>
                                    <form class="register" id="registerSubmit" action="/register__User" method="post"
                                        enctype="multipart/form-data">

                                        <!-- <div class="vendor_gstbtn form-row-wide">

                                            <div class="text ">GST</div>
                                            <div>

                                                <label class="switch_vendorGst">
                                                    <input name="gstSwitch" class="gstSwitch" type="checkbox"
                                                        id="switchVal" value="0" hidden>
                                                    <span class="slider_vendorGst round"></span>
                                                </label>
                                            </div>
                                        </div> -->

                                        <!-- {% if role %}

                                        <span id="gst_invalid" class="hidden  mob-helpers">
                                            Please enter valid Gst number.
                                        </span>
                                        <div class="gst_invlidmsg"> </div>
                                        <p class="form-row Gst_Hide form-row-wide">
                                            <label class="text">GST Number</label>
                                            <input title="gst_number" name="gst_No" id="vendor_gstNo" maxlength="15"
                                                type="text" class="input_Gst">
                                        </p>
                                        {% endif %} -->


                                        <p class="form-row form-row-wide">
                                            <label class="text">First Name</label>
                                            <input title="name" name="firstname" value="" type="text" class="input-text"
                                                required>
                                        </p>
                                        <p class="form-row form-row-wide">
                                            <label class="text">Last Name</label>
                                            <input title="name" name="lastname" value="" type="text" class="input-text"
                                                required>
                                        </p>

                                        <p class="form-row form-row-wide">
                                            <label class="text">Email</label>
                                            <input title="email" name="email" type="email" class="input-text" required>
                                        </p>

                                        <p class="form-row form-row-wide">
                                            <label class="text">Password</label>
                                            <input name="password" minlength="6" maxlength="6" type="password"
                                                class="input-text" id="password_un"
                                                placeholder="Use 6 characters with a mix of letters, numbers & symbols."
                                                title="Use 6 characters with a mix of letters, numbers & symbols."
                                                pattern="(?=^.{5,}$)(?=.*\d)(?=.*[!@#$%^&*]+)(?![.\n])(?=.*[A-Z])(?=.*[a-z]).*$"
                                                required>
                                        </p>
                                        <p class="form-row form-row-wide">
                                            <label class="text">Confirm Password</label>
                                            <input title="password" name="confirm_password" id="confirm_password"
                                                minlength="6" maxlength="6" type="password" value="" class="input-text"
                                                required>
                                        <div style="margin-top: 7px;" id="CheckPasswordMatch"></div>
                                        </p>
                                        <p>
                                            <span id="mobile-valid" class="hidden mob">

                                            </span>
                                            <span id="folio-invalid" class="hidden  mob-helpers">
                                                Please enter valid mobile No
                                            </span>
                                        </p>
                                        <p class="form-row form-row-wide">
                                            <label class="text">Mobile </label>
                                            <input title="Mobile" name="phone" id="mobile-num" type="text"
                                                class="input-text" maxlength="10" required>
                                        </p>

                                        <span id="gst_invalid" class="hidden  mob-helpers">
                                            Please enter valid Gst number.
                                        </span>
                                        <div class="gst_invlidmsg"> </div>
                                        <p class="form-row  form-row-wide">
                                            <label class="text">GST Number</label>
                                            <input title="gst_number" name="gst_No" id="vendor_gstNo" maxlength="15"
                                                type="text" class="input_Gst" required>
                                        </p>

                                        <p class="form-row form-row-wide">
                                            <label class="text">Company</label>
                                            <input title="name" name="companyName" value="" id="vendor_Company"
                                                type="text" class="input-text" required>
                                        </p>

                                        <!-- <p class="form-row form-row-wide">
                                            <label for="myfile">Select a file:</label>
                                            <input type="file" id="kycImage" name="kycImage"
                                                accept="image/x-png,image/gif,image/jpeg,.pdf" required>
                                        </p> -->


                                        <p class="form-row form-row-wide">
                                            <label class="text">Captcha Code</label>
                                        <div id="captcha">
                                        </div>
                                        <input type="text" class="cpatcha_code" placeholder="Captcha"
                                            id="cpatchaTextBox" required>

                                        <span class=" valid_msg" style="display: none; color: red;">
                                            Valid Captcha.
                                        </span>

                                        <span class="captcha_msg" style="display: none; color: red;">
                                            Invalid Captcha. try Again
                                        </span>
                                        </p>

                                        <p class="form-row">
                                            <span class="inline">
                                                <!-- <input type="checkbox" name="term_and_condition" id="cb2"
                                                    title="Please select term and condition.">
                                                <label for="cb2" class="label-text">I agree to <span>Terms &
                                                        Conditions</span></label> -->

                                                <input type="checkbox" name="ll" id="ll" required="required"
                                                    style="display: block">
                                                <label for="ll" class="text">I agree to <span>Terms &
                                                        Conditions</span> </label>
                                            </span>
                                        </p>

                                        <p class="">
                                            <input type="submit" id="submit" class="button-submit" value="Register Now">
                                        </p>

                                    </form>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

{% endblock %}

{% block Jscript %}
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
<script>

    $(document).ready(function () {
        $("#hidefrom_productpage").css({ 'display': 'none' });
        $("#hidefrom_homepage").css({ 'display': 'none' });

        createCaptcha();
        // $("#confirm_password").on('keyup', function(){
        //     var password = $("#password_un").val();
        //     var confirm_password = $("#confirm_password").val();
        //     if(password.length != 0 && confirm_password != 0){
        //     if (password != confirm_password)
        //         $("#CheckPasswordMatch").html("Password does not match !").css("color","red");
        //     else
        //         $("#CheckPasswordMatch").html("Password match !").css("color","green");
        //     }
        // });
        // $("#password_un").on('keyup', function(){

        //         $("#CheckPasswordMatch").html("");
        // });

        $("#confirm_password").on('keyup', function () {
            var password = $("#password_un").val();
            var confirm_password = $("#confirm_password").val();
            if (password.length != 0 && confirm_password != 0) {
                if (password != confirm_password) {
                    $("#CheckPasswordMatch").html("Password does not match !").css("color", "red");
                    $("#submit").prop("disabled", true);
                    $("#submit").addClass("submitbtn");

                } else {
                    $("#CheckPasswordMatch").html("Password match !").css("color", "green");
                    $("#submit").removeClass("submitbtn");
                    $("#submit").prop("disabled", false);
                }
            }
        });
        $("#password_un").on('keyup', function () {

            $("#CheckPasswordMatch").html("");
        });

        $('#cb2').prop('required', true);

        $(".Gst_Hide").hide();
        $('#switchVal').click(function () {
            $('.Gst_Hide').toggle();
        });
    });

    var companyName;
    $("#vendor_gstNo").keyup(function (e) {
        var gstValue = $("#vendor_gstNo").val();
        $('.gst_invlidmsg').html('');
        // console.log(gstValue, "fsfuwehfuwehf");

        e.preventDefault()
        if ($(this).val().length == 15) {
            $.ajax({
                url: "/validationGst",
                type: "POST",
                dataType: "json",
                data: { gstValue },
                success: function (result) {
                    companyName = result.data.tradename;
                    $(".gst_invlidmsg").html(result.data);
                    // console.log("result", result.data);
                    $("#vendor_Company").attr('value', result.data.tradename);
                    $("#vendor_Company").val(result.data.tradename);
                },
                error() {
                    console.log("error");
                }
            })
        } else {
            // Disable submit button
        }
    });

    $("#registerSubmit").on("submit", function () {
        $("#vendor_Company").removeAttr("disabled");
        var form = $('form').serialize();
        $('input[disabled]').each(function () {
            form = form + '&' + $(this).attr('name') + '=' + $(this).val();
        });
        $.ajax({
            type: "POST",
            dataType: "json",
            data: $("#registerSubmit").serialize(),
        })
    });

    $("#switchVal").on("click", function () {
        if ($("#switchVal").val() == 0) {
            $("#switchVal").val(1);
        }
        else {
            $("#switchVal").val(0);
        }
        // alert($("#switchVal").val());
        var toggle = $("#vendor_Company").prop("disabled");
        $("#gst_invalid").addClass("hidden");
        $("#vendor_Company").prop("disabled", !toggle);

        $(':input[type="submit"]').prop('', false);
        $("#vendor_Company").val("");

    });

</script>
<script>
    $(document).ready(function () {

        $("#mobile-num").keyup(function () {
            var mobNum = $(this).val();
            var filter = /^\d*(?:\.\d{1,2})?$/;

            if (filter.test(mobNum)) {
                if (mobNum.length == 10) {
                    // alert("valid");
                    $("#mobile-valid").removeClass("hidden");
                    $("#folio-invalid").addClass("hidden");
                } else {
                    //   alert('Please put 10  digit mobile number');
                    $("#folio-invalid").removeClass("hidden");
                    $("#mobile-valid").addClass("hidden");
                    return false;
                }
            }
            else {
                // alert('Not a valid number');
                $("#folio-invalid").removeClass("hidden");
                $("#mobile-valid").addClass("hidden");
                return false;
            }

        });

        $("#vendor_gstNo").keyup(function () {
            var gstNum = $(this).val();
            if (gstNum.length == 15) {

                $("#mobile-valid").removeClass("hidden");
                $("#gst_invalid").addClass("hidden");
            } else {

                $("#gst_invalid").removeClass("hidden");
                $("#mobile-valid").addClass("hidden");
                return false;
            }

        });

        // var $validator = $("#registerSubmit").validate({
        //     ignore: [],
        //     rules: {
        //         term_and_condition: {
        //             onecheck: true
        //         }
        //     }
        // });

    });
</script>
<script>
    $(document).ready(function () {

        var ismobile = $("#ismobile").attr("value");
        if (ismobile == true) {
            $("#loginSubmit_email").css("display", "none");
            $("#loginSubmit_mobile").css("display", "block");
        } else {
            $("#loginSubmit_email").css("display", "block");
            $("#loginSubmit_mobile").css("display", "none");
        }

        $("#login_Email").css("background-color", "#7dd857");
        $("#login_Email").css("color", "#fff");


        $(".moblie_otpLogin").css("display", "none");
        $("#login_Email").click(function () {
            $("#loginSubmit_email").css("display", "block");
            $("#loginSubmit_mobile").css("display", "none");
            $("#login_Phone").css("background-color", "transparent");
            $("#login_Email").css("color", "#fff");
            $("#login_Phone").css("color", "#000");
            $("#login_Email").css("background-color", "#7dd857");


        });
        $("#login_Phone").click(function () {
            $("#loginSubmit_email").css("display", "none");
            $("#loginSubmit_mobile").css("display", "block");
            $("#login_Email").css("background-color", "transparent");
            $("#login_Phone").css("color", "#fff");
            $("#login_Email").css("color", "#000");
            $("#login_Phone").css("background-color", "#7dd857");
            $(".moblie_otpLogin").css("display", "none");
            $("#otp_Send").css("display", "block");

        });


        // $("#otp_Send").click(function () {
        //     $(".moblie_otpLogin").css("display", "block");
        //     $("#otp_Send").css("display", "none");


        // });

    });
</script>

<script>
    var code;
    function createCaptcha() {
        //clear the contents of captcha div first 
        document.getElementById('captcha').innerHTML = "";
        var charsArray =
            "0123456789";
        var lengthOtp = 6;
        var captcha = [];
        for (var i = 0; i < lengthOtp; i++) {
            //below code will not allow Repetition of Characters
            var index = Math.floor(Math.random() * charsArray.length + 1); //get the next character from the array
            if (captcha.indexOf(charsArray[index]) == -1)
                captcha.push(charsArray[index]);
            else i--;
        }
        var canv = document.createElement("canvas");
        canv.id = "captcha";
        canv.width = 100;
        canv.height = 50;
        var ctx = canv.getContext("2d");
        ctx.font = "25px Georgia";
        ctx.strokeText(captcha.join(""), 0, 30);
        //storing captcha so that can validate you can save it somewhere else according to your specific requirements
        code = captcha.join("");
        document.getElementById("captcha").appendChild(canv); // adds the canvas to the body element
    }
    // function validateCaptcha() {
    //     event.preventDefault();
    //     // debugger
    //     if (document.getElementById("cpatchaTextBox").value == code) {

    //         $(".captcha_msg").css("display", "none");
    //         $(".cpatcha_code").css("color", "green");
    //         $(".cpatcha_code").css("border-color", "green");
    //         $(".valid_msg").css("display", "block");
    //         check_fun = true;
    //     } else {

    //         $(".valid_msg").css("display", "none");
    //         $(".captcha_msg").css("display", "block");
    //         $(".cpatcha_code").css("color", "red");
    //         $(".cpatcha_code").css("border-color", "red");
    //         createCaptcha();

    //         check_fun = false;
    //     }
    // }

    $("#cpatchaTextBox").on('keyup', function () {
        validateCaptcha()
    });
    function validateCaptcha() {
        event.preventDefault();
        // debugger
        if (document.getElementById("cpatchaTextBox").value == code) {

            $(".captcha_msg").css("display", "none");
            $(".cpatcha_code").css("color", "green");
            $(".cpatcha_code").css("border-color", "green");
            $(".valid_msg").css("display", "block");
            $("#submit").prop("disabled", false);

        } else {
            $("#submit").prop("disabled", true);
            $(".valid_msg").css("display", "none");
            $(".captcha_msg").css("display", "block");
            $(".cpatcha_code").css("color", "red");
            $(".cpatcha_code").css("border-color", "red");
            // createCaptcha();

        
        }
    }

    $("#cpatchaTextBox").keyup(function () {
        $(".cpatcha_code").css("color", "black");
        $(".cpatcha_code").css("border-color", "#f1f1f1");
        $(".captcha_msg").css("display", "none");
        $(".valid_msg").css("display", "none");
    });

</script>

{% endblock %}